/**
 * Synchronize.js
 * Compiled on 23.04.2016
 * Version 1.2.6
 *
 *  Copyright (C) 2013-2016 Denis Meyer, calltopower88@googlemail.com
 * All rights reserved.

 * Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
 * 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.

 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS
 * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
 * GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
 * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
!function(a){function b(a){ga&&window.console&&console.log(a)}function c(a,b,c){return!isNaN(a)&&!isNaN(b)&&!isNaN(c)&&c>=b?a>=b&&c>=a:!1}function d(c){return c?f()?videojs(c):a("#"+c):void b("SJS: [getVideoObj] Undefined video element id '"+c+"'")}function e(a){return a?f()?videojs(a):d(a).get(0):void b("SJS: [getVideo] Undefined video element id '"+a+"'")}function f(){return"undefined"!=typeof videojs}function g(a){if(f()&&a){var b=a.id();return""!==b?b:a}return a}function h(a){return n(a)?G()?ma?(b("SJS: [play] A video is currently buffering"),!1):a?(f()?e(a).paused()&&e(a).ended()||(b("SJS: [play] Playing video element id '"+a+"'"),e(a).play()):(e(a).paused||!e(a).ended)&&(b("SJS: [play] Playing video element id '"+a+"'"),e(a).play()),!0):(b("SJS: [play] Undefined video element id '"+a+"'"),!1):(b("SJS: [play] Not all video IDs are ready, yet"),!1):!1}function i(a){if(!a)return void b("SJS: [mute] Undefined video element id '"+a+"'");var c=e(a);f()?c.volume()>0&&(b("SJS: [mute] Muting video element id '"+a+"'"),c.volume(0)):c.muted||(b("SJS: [mute] Muting video element id '"+a+"'"),c.muted=!0)}function j(a,c){if(a&&c){b("SJS: [unmute] Unmuting video element id '"+a+"'");var d=e(a);return f()?d.volume(c):(d.muted=!1,d.volume(c)),!0}return b("SJS: [unmute] Undefined video element id '"+a+"'"),!1}function k(a){return a?(b("SJS: [volume] Getting volume from video element id '"+a+"': "+e(a).volume()),e(a).volume()):(b("SJS: [volume] Undefined video element id '"+a+"'"),-1)}function l(a){return a?(b("SJS: [pause] Pausing video element id '"+a+"'"),e(a).pause()):(b("SJS: [pause] Undefined video element id '"+a+"'"),!1)}function m(a){for(var b=0;b<ha.length;++b)(a&&ha[b]===P||ha[b]!==P)&&l(ha[b])}function n(a){return a?f()?(a===P&&console.error("IS PAUSED",e(a).paused()),e(a).paused()):e(a).paused:(b("SJS: [isPaused] Undefined video element id '"+a+"'"),!1)}function o(a){return a?f()?e(a).duration():e(a).duration:(b("SJS: [getDuration] Undefined video element id '"+a+"'"),-1)}function p(a){return a?f()?e(a).currentTime():e(a).currentTime:(b("SJS: [getCurrentTime] Undefined video element id '"+a+"'"),-1)}function q(a,c){if(a){var d=o(a);return-1!==d&&!isNaN(c)&&c>=0&&d>=c?(f()?e(a).currentTime(c):e(a).currentTime=c,!0):(b("SJS: [setCurrentTime] Could not set time for video element id '"+a+"'"),q(a,d),!1)}return b("SJS: [setCurrentTime] Undefined video element id '"+a+"'"),!1}function r(a){return a?f()?e(a).playbackRate():e(a).playbackRate:(b("SJS: [getPlaybackRate] Undefined video element id '"+a+"'"),1)}function s(a,c){return a?(f()?e(a).playbackRate(c):e(a).playbackRate=c,!0):(b("SJS: [setPlaybackRate] Undefined video element id '"+a+"'"),!1)}function t(a){return a?f()?e(a).buffered():e(a).buffered:void b("SJS: [getBufferTimeRange] Undefined video element id '"+a+"'")}function u(a){var b=p(P),d=p(a);return-1===b||-1===d||c(d,b-Y,b)?0:d-b}function v(){ha=[],ia={},ja={},ka=0,P=null,la=0,ma=!1,na=!1,oa=!1,Q=null,pa=!1,qa=!1,sa=!1,ra=!1,ta=null,ua=1e4,va=!1,wa=null,xa=[],ya=!1}function w(){if(ha.length<=1)return!1;for(var a=k(P),b=0;b<ha.length;++b)if(ha[b]!==P){d(P).off(),D(b);break}return B(),j(P,a),!0}function x(c){if(b("Unsynchronizing video with id "+c),c===P){var e=d(P);if(e&&(e.off("play"),e.off("pause"),e.off("ratechange"),e.off("ended"),e.off("timeupdate")),!w())return void z()}for(var f=0;f<ha.length;++f)if(ha[f]===c){ha.splice(f,1),a(document).trigger("sjs:idUnregistered",[c]);break}B(),A()}function y(c){b("Adding video with id "+c+" to synchronization");for(var d=0;d<ha.length;++d)if(ha[d]===c)return;ha.push(c),a(document).trigger("sjs:idRegistered",[c]),A()}function z(){b("Unsynchronizing all videos");var a=d(P);a&&(a.off("play"),a.off("pause"),a.off("ratechange"),a.off("ended"),a.off("timeupdate")),v()}function A(){W=Date.now();for(var c=0;c<ha.length;++c)if(ha[c]!==P){var d=!1,e=u(ha[c]);i(ha[c]);var f=n(P);if(f)d=!0;else if(ya)ya&&(Math.abs(e)>ea&&Math.abs(e)>ba?d=!0:n(P)||xa[ha[c]]||(b("SJS: [synchronize] Playing video element id '"+ha[c]+"'"),h(ha[c])));else{var g=r(ha[c]),j=r(P);e>ca?Math.abs(e)<Z?(a(document).trigger("sjs:synchronizing",[p(P),ha[c]]),g!==j&&(b("SJS: [synchronize] Decreasing playback rate of video element id '"+ha[c]+"' from "+g+" to "+(j+_)),s(ha[c],j+_))):(a(document).trigger("sjs:synchronizing",[p(P),ha[c]]),s(ha[c],r(P)),d=!0):da>e?Math.abs(e)<Z?(a(document).trigger("sjs:synchronizing",[p(P),ha[c]]),g!==j&&(b("SJS: [synchronize] Increasing playback rate of video element id '"+ha[c]+"' from "+g+" to "+(j+$)),s(ha[c],j+$))):(a(document).trigger("sjs:synchronizing",[p(P),ha[c]]),s(ha[c],r(P)),d=!0):n(P)||xa[ha[c]]||(s(ha[c],r(P)),b("SJS: [synchronize] Playing video element id '"+ha[c]+"'"),h(ha[c]))}d&&(a(document).trigger("sjs:synchronizing",[p(P),ha[c]]),f?(b("SJS: [synchronize] Seeking video element id '"+ha[c]+"': "+p(P)),q(ha[c],p(P))&&(b("SJS: [synchronize] Pausing video element id '"+ha[c]+"' after seeking"),l(ha[c]))):(b("SJS: [synchronize] Seeking video element id '"+ha[c]+"': "+(p(P)+aa)),q(ha[c],p(P)+aa)&&(h(ha[c]),xa[ha[c]]||(b("SJS: [synchronize] Playing video element id '"+ha[c]+"' after seeking"),h(ha[c])))))}}function B(){if(F()){var c=d(P);ya=0!==a("#"+P+"_flash_api").length,c.on("play",function(){b("SJS: Master received 'play' event"),a(document).trigger("sjs:masterPlay",[p(P)]),sa=!1,!oa&&R&&(oa=!0,C());for(var c=0;c<ha.length;++c)ha[c]!==P&&(h(ha[c]),i(ha[c]))}),c.on("pause",function(){b("SJS: Master received 'pause' event"),a(document).trigger("sjs:masterPause",[p(P)]),sa=!qa,qa=!1,m(!0)}),c.on("ratechange",function(){b("SJS: Master received 'ratechange' event"),a(document).trigger("sjs:masterPlaybackRateChanged",[r(P)]);for(var c=0;c<ha.length;++c)ha[c]!==P&&s(ha[c],r(P))}),c.on("ended",function(){b("SJS: Master received 'ended' event"),a(document).trigger("sjs:masterEnded",[o(P)]),sa=!0,m(!1),A()}),c.on("timeupdate",function(){a(document).trigger("sjs:masterTimeupdate",[p(P)]),sa=sa||!n(P),(Date.now()-W>=X||n(P))&&A()})}else m(!0)}function C(){Q=window.setInterval(function(){var b,d=!0;for(b=0;b<ha.length;++b){var e=t(ha[b]);if(e){for(var f=o(ha[b]),g=p(ha[b])+U,i=!1,j=0;j<e.length&&!i;++j)g=g>=f?f:g,c(g,e.start(j),e.end(j)+fa)&&(i=!0);d=d&&i,ma=!d}}d?pa&&!sa?(pa=!1,h(P),sa=!1,a(document).trigger("sjs:bufferedAndAutoplaying",[])):pa&&(pa=!1,a(document).trigger("sjs:bufferedButNotAutoplaying",[])):(pa=!0,qa=!0,m(!0),a(document).trigger("sjs:buffering",[]))},S)}function D(b){ka=b<ha.length?b:0,P=ha[ka],a(document).trigger("sjs:masterSet",[P])}function E(a,c){""!==a?d(a).on("loadeddata",function(){va=!0,c&&c()}):b("SJS: [doWhenDataLoaded] Undefined video element id '"+a+"'")}function F(){if(f()){for(var a=0;a<ha.length;++a)if(!ja[ha[a]])return!1;return!0}return la===ha.length}function G(){if(f()){for(var a=0;a<ha.length;++a)if(!ia[ha[a]])return!1;return!0}return la===ha.length}function H(){m(!0),na=!0}function I(){m(!0),na=!1}function J(){null!==ta&&(window.clearInterval(ta),ta=null)}function K(b){var c;if(f())for(c=0;c<ha.length;++c)a(document).trigger("sjs:idRegistered",[ha[c]]),d(ha[c]).on("play",H),d(ha[c]).on("pause",I),d(ha[c]).ready(function(){var c=g(this);ia[c]=!0,E(c,function(){if(ja[c]=!0,a(document).trigger("sjs:playerLoaded",[c]),F()){D(b);for(var e=0;e<ha.length;++e)d(ha[e]).off("play",H),d(ha[e]).off("pause",I);B(),na&&h(P),a(document).trigger("sjs:allPlayersReady",[])}}),wa=window.setInterval(function(){if(va)window.clearInterval(wa),wa=null;else for(var a=0;a<ha.length;++a)d(ha[a]).trigger("loadeddata")},T)});else for(c=0;c<ha.length;++c)a(document).trigger("sjs:idRegistered",[ha[c]]),d(ha[c]).on("play",H),d(ha[c]).on("pause",I),d(ha[c]).ready(function(){if(++la,F()){D(b);for(var c=0;c<ha.length;++c)d(ha[c]).off("play",H),d(ha[c]).off("pause",I);B(),na&&h(P),a(document).trigger("sjs:allPlayersReady",[])}})}function L(){V&&a(document).on("sjs:buffering",function(){b("SJS: Received 'sjs:buffering' event"),ta=setInterval(function(){F()&&!sa&&(sa=!1,h(P),J())},ua)}).on("sjs:bufferedAndAutoplaying",function(){b("SJS: Received 'sjs:bufferedAndAutoplaying' event"),J()}).on("sjs:bufferedButNotAutoplaying",function(){b("SJS: Received 'sjs:bufferedButNotAutoplaying' event"),J()})}function M(){a(document).on("sjs:play",function(){b("SJS: Received 'sjs:play' event"),F()&&h(P)}).on("sjs:pause",function(){b("SJS: Received 'sjs:pause' event"),F()&&l(P)}).on("sjs:setCurrentTime",function(a,c){b("SJS: Received 'sjs:setCurrentTime' event"),F()&&q(P,c)}).on("sjs:synchronize",function(){b("SJS: Received 'sjs:synchronize' event"),F()&&A()}).on("sjs:addToSynch",function(a,c){b("SJS: Received 'sjs:addToSynch' event"),c&&y(c)}).on("sjs:removeFromSynch",function(a,c){b("SJS: Received 'sjs:removeFromSynch' event"),c&&x(c)}).on("sjs:unsynchronize",function(){b("SJS: Received 'sjs:unsynchronize' event"),z()}).on("sjs:startBufferChecker",function(){b("SJS: Received 'sjs:startBufferChecker' event"),oa||(window.clearInterval(Q),oa=!0,C())}).on("sjs:stopBufferChecker",function(){b("SJS: Received 'sjs:stopBufferChecker' event"),window.clearInterval(Q),oa=!1,ma=!1})}function N(b,c,d){var e,g=!0;if(2===d.length){var h=a('video[mediagroup="'+c+'"]');for(e=0;e<h.length;++e){var i=ha.length;ha[i]=h[e].getAttribute("id");var j="_html5_api";ha[i]=f()&&-1!==ha[i].indexOf(j)?ha[i].substr(0,ha[i].length-j.length):ha[i],ia[ha[e-1]]=!1,ja[ha[e-1]]=!1}}else for(ka=b,e=1;e<d.length;++e)g=g&&d[e]&&a("#"+d[e]).length,g?(ha[ha.length]=d[e],ia[ha[e-1]]=!1,ja[ha[e-1]]=!1):a(document).trigger("sjs:invalidId",[d[e]]);return g}function O(c,d){var e=N(c,d,arguments);e&&ha.length>1?K(c):(b("SJS: Not enough videos"),a(document).trigger("sjs:notEnoughVideos",[])),L(),M()}var P,Q,R=!0,S=1e3,T=5e3,U=2,V=!0,W=0,X=1e3,Y=1,Z=4,$=.5,_=-.5,aa=.25,ba=aa+.05,ca=.05,da=-.05,ea=.05,fa=.3,ga=!1,ha=[],ia={},ja={},ka=0,la=0,ma=!1,na=!1,oa=!1,pa=!1,qa=!1,ra=!1,sa=!1,ta=null,ua=1e4,va=!1,wa=null,xa=[],ya=!1;a.synchronizeVideos=O,a(document).on("sjs:debug",function(a,c){ga=c,b("SJS: Received 'sjs:debug' event")})}(jQuery);