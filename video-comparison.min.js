var VCSJS=function(){return{options:{classNames:{wrapper:"vcs_wrapper",slider:"vcs_slider",video:"vcs_video",video_left:"vcs_video_l",video_right:"vcs_video_r",loading:"vcs_loading"}},init:function(){var self=this;window.addEventListener("load",self.start)},start:function(){VCSJS.getSliders()},getSliders:function(){this.vcsElements=document.getElementsByClassName(this.options.classNames.wrapper),this.initSliders()},initSliders:function(){for(var i=0;i<this.vcsElements.length;i++)this.addSliderMarkup(this.vcsElements[i])},addSliderMarkup:function(wrapper){var loadingElement=document.createElement("div");loadingElement.className=this.options.classNames.loading,loadingElement.innerHTML="Loading ...",wrapper.appendChild(loadingElement);var docFrag=document.createDocumentFragment(),sliderElement=document.createElement("div"),sliderSpan=document.createElement("span");sliderElement.className=this.options.classNames.slider,sliderSpan.innerHTML="&harr;",sliderElement.appendChild(sliderSpan),docFrag.appendChild(sliderElement);var videoElements=wrapper.getElementsByTagName("video");if(2==videoElements.length){for(var videoId=Math.random().toString(36).substring(7),i=0;2>i;i++){var videoWrapper=document.createElement("div"),videoElement=videoElements[0];videoElement.id=videoId+"_"+i,videoWrapper.className=0==i?this.options.classNames.video+" "+this.options.classNames.video_left:this.options.classNames.video+" "+this.options.classNames.video_right,wrapper.removeChild(videoElements[0]),videoWrapper.appendChild(videoElement),docFrag.appendChild(videoWrapper)}wrapper.appendChild(docFrag);var pseudoElement=document.createElement("div"),ar=this.getAr(wrapper);pseudoElement.style.paddingBottom=ar+"%",wrapper.appendChild(pseudoElement),this.addListeners(wrapper)}else console.log("vcsjs-error: there are more or less than 2 video elements in this wrapper.");return!0},getAr:function(wrapper){var video=wrapper.getElementsByTagName("video")[0],ar=video.videoHeight/video.videoWidth*100;return ar},addListeners:function(wrapper){var self=this;wrapper.getElementsByClassName(this.options.classNames.slider)[0].firstChild.addEventListener("mousedown",function(){wrapper.addEventListener("mousemove",VCSJS.slide,!0)},!1),window.addEventListener("mouseup",function(){wrapper.removeEventListener("mousemove",VCSJS.slide,!0)},!1);for(var videos=wrapper.getElementsByTagName("video"),video=videos[0],i=0;i<videos.length;i++)videos[i].parentNode.addEventListener("click",function(){var video=this.getElementsByTagName("video")[0],wrapper=this.parentNode,videos=wrapper.getElementsByTagName("video");if(video.paused)for(var j=0;j<videos.length;j++)videos[j].play(),"undefined"!=typeof jQuery&&"function"==typeof jQuery.synchronizeVideos&&jQuery(document).trigger("sjs:play");else for(var j=0;j<videos.length;j++)videos[j].pause(),"undefined"!=typeof jQuery&&"function"==typeof jQuery.synchronizeVideos&&jQuery(document).trigger("sjs:pause")});"true"==wrapper.getAttribute("data-loop")&&video.addEventListener("ended",function(){self.playVideos(wrapper)},!1),this.syncVideos(wrapper)},syncVideos:function(wrapper){if("undefined"!=typeof jQuery){if("function"==typeof jQuery.synchronizeVideos){var videos=wrapper.getElementsByTagName("video");videos[0].loop=!0,videos[1].loop=!0,jQuery.synchronizeVideos(0,videos[0].id,videos[1].id),jQuery(document).trigger("sjs:play");var self=this;setTimeout(function(){self.showSlider(wrapper)},100)}}else{var self=this;this.playVideos(wrapper),setTimeout(function(){self.showSlider(wrapper)},100)}},showSlider:function(wrapper){var video=wrapper.getElementsByTagName("video")[0];wrapper.getElementsByClassName(this.options.classNames.loading)[0].style.opacity=0,wrapper.style.maxHeight=video.videoHeight+10+"px",wrapper.style.maxWidth=video.videoWidth+"px"},slide:function(e){var clientRect=this.getClientRects()[0],pos=(e.clientX-clientRect.left)/clientRect.width*100,slider=this.getElementsByClassName(VCSJS.options.classNames.slider)[0];slider.style.left=pos+"%",this.getElementsByClassName(VCSJS.options.classNames.video_left)[0].style.width=pos+"%";var video_right=this.getElementsByClassName(VCSJS.options.classNames.video_right)[0];video_right.style.width=100-pos+"%",video_right.style.left=pos+"%";var videoElRight=video_right.getElementsByTagName("video")[0];videoElRight.style.left=-slider.getClientRects()[0].left+clientRect.left+"px"},playVideos:function(wrapper){for(var videos=wrapper.getElementsByTagName("video"),i=0;i<videos.length;i++)videos[i].currentTime=0,"undefined"!=typeof jQuery?"function"==typeof jQuery.synchronizeVideos&&jQuery(document).trigger("sjs:play"):videos[i].play()}}}();VCSJS.init();